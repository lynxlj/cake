"use strict";require(["config"],function(){require(["jquery","header","footer","template","cookie"],function(p,t,i,o){t.init(),i.init(),console.log(p.cookie("cart")),p(function(){function h(){var t=p.cookie("cart");if(t){for(var i=t.split("$"),n=0;n<i.length;n++)i[n]=JSON.parse(i[n]);var e=o("list",{data:i});p("#each_pro").html(e);var r=0;i=t.split("$");for(n=0;n<i.length;n++)r+=JSON.parse(i[n]).price*JSON.parse(i[n]).num;p(".allMoney").html("商品金额："+r+".00"),100<r?(p(".ps").html("配送费：0.00"),p(".lastAllMoney").html(r+".00")):(p(".ps").html("配送费：10.00"),p(".lastAllMoney").html(r+10+".00"))}else p(".cart-empty").css("display","block"),p("#cart").css("display","none")}function n(){p(".cart-empty").css("display","block"),p("#cart").css("display","none"),p(".allMoney").html("商品金额：0.00"),p(".ps").html("配送费：10.00"),p(".lastAllMoney").html("0.00")}h(),p("tbody").on("click",".action-birthday_card",function(){p(this).children(".action-birthday-options").css("display","block"),p(this).children(".action-birthday-options").children().on("click",function(){p(this).parent().parent().children("span").html(p(this).html()),p(this).parent().hover(function(){},function(){p(this).css("display","none")})}),p(".action-birthday-options").hover(function(){},function(){p(this).css("display","none")})}),p("tbody").on("click",".minus",function(){var t=parseInt(p(this).siblings(".pro_num").val());console.log(t),t<=1?t=1:t--,p(this).siblings(".pro_num").val(t);for(var i=p(this).parent().parent().siblings(".goods-cake").children().children("h4").children("a").html(),n=p(this).parent().parent().siblings(".cart-unit-Price").html(),e=p.cookie("cart"),r=(e=e.split("$")).length,o=[],s=0;s<r;s++){var a=JSON.parse(e[s]);if(a.name==i&&a.price==n){a.num=t;var l=JSON.stringify(a);o.push(l)}else{l=JSON.stringify(a);o.push(l)}}p.cookie("cart",o.join("$"),{path:"/"}),h();n=p(this).parent().parent().siblings(".cart-unit-Price").html();p(this).parent().parent().siblings(".money").html((n*t).toFixed(2))}),p("tbody").on("click",".plus",function(){var t=parseInt(p(this).siblings(".pro_num").val());t++,p(this).siblings(".pro_num").val(t);var i=p(this).parent().parent().siblings(".cart-unit-Price").html();console.log(i),p(this).parent().parent().siblings(".money").html((i*t).toFixed(2));for(var n=p(this).parent().parent().siblings(".goods-cake").children().children("h4").children("a").html(),e=(i=p(this).parent().parent().siblings(".cart-unit-Price").html(),p.cookie("cart")),r=(e=e.split("$")).length,o=[],s=0;s<r;s++){var a=JSON.parse(e[s]);if(a.name==n&&a.price==i){var l=a.num;l++,a.num=l;var c=JSON.stringify(a);o.push(c)}else{c=JSON.stringify(a);o.push(c)}}p.cookie("cart",o.join("$"),{path:"/"}),h()}),p("tbody").on("click",".delete a",function(){var t=p(this).parent().parent().index(),i=p.cookie("cart").split("$");i.splice(t,1),p.cookie("cart",i.join("$"),{path:"/"}),p(this).parent().parent().remove(),h(),p.cookie("cart")||n()}),p(".clear").on("click",function(){p.cookie("cart","",{expires:-1,path:"/"}),p("#cart").remove(),n()}),p("#action-submit-btn").on("click",function(){"true"==p.cookie("islogin")?alert("周思佚继续吃，唐纯别吃了，这么胖！！！"):(alert("请先登录你的账号！"),window.location.href="/html/login.html")})})})});